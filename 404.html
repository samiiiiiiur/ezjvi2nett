<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><title>404</title><link rel="stylesheet" href="./style.css"></head><body><canvas></canvas><!-- partial --><script>"use strict";var tetrominos=[{colors:["rgb(59,84,165)","rgb(118,137,196)","rgb(79,111,182)"],data:[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]]},{colors:["rgb(214,30,60)","rgb(241,108,107)","rgb(236,42,75)"],data:[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]]},{colors:["rgb(88,178,71)","rgb(150,204,110)","rgb(115,191,68)"],data:[[0,0,0,0],[0,1,1,0],[0,0,1,1],[0,0,0,0]]},{colors:["rgb(62,170,212)","rgb(120,205,244)","rgb(54,192,240)"],data:[[0,0,0,0],[0,1,1,1],[0,0,1,0],[0,0,0,0]]},{colors:["rgb(236,94,36)","rgb(234,154,84)","rgb(228,126,37)"],data:[[0,0,0,0],[0,1,1,0],[1,1,0,0],[0,0,0,0]]},{colors:["rgb(220,159,39)","rgb(246,197,100)","rgb(242,181,42)"],data:[[0,0,1,0],[0,0,1,0],[0,1,1,0],[0,0,0,0]]},{colors:["rgb(158,35,126)","rgb(193,111,173)","rgb(179,63,151)"],data:[[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]]}],Tetris=function(t,i,r,e){this.posX=t||0,this.posY=i||0,this.width=r||window.innerWidth,this.height=e||window.innerHeight,this.bgCanvas=document.createElement("canvas"),this.fgCanvas=document.createElement("canvas"),this.bgCanvas.width=this.fgCanvas.width=this.width,this.bgCanvas.height=this.fgCanvas.height=this.height,this.bgCtx=this.bgCanvas.getContext("2d"),this.fgCtx=this.fgCanvas.getContext("2d"),this.bgCanvas.style.left=this.posX+"px",this.bgCanvas.style.top=this.posY+"px",this.fgCanvas.style.left=this.posX+"px",this.fgCanvas.style.top=this.posY+"px",document.body.appendChild(this.bgCanvas),document.body.appendChild(this.fgCanvas),this.init()};Tetris.prototype.init=function(){this.curPiece={data:null,colors:[0,0,0],x:0,y:0},this.lastMove=Date.now(),this.curSpeed=50+50*Math.random(),this.unitSize=20,this.linesCleared=0,this.level=0,this.loseBlock=0,this.board=[],this.boardWidth=Math.floor(this.width/this.unitSize),this.boardHeight=Math.floor(this.height/this.unitSize);var t=this.board,i=this.boardWidth,r=this.boardHeight,e=r/2,o=this.curPiece,a=0,s=0;for(a=0;a<=i;a++)for(t[a]=[],s=0;s<=r;s++)t[a][s]={data:0,colors:["rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)"]},Math.random()>.15&&s>e&&(t[a][s]={data:1,colors:tetrominos[Math.floor(Math.random()*tetrominos.length)].colors});for(a=0;a<=i;a++)for(s=r-1;s>-1;s--)if(0===t[a][s].data&&s>0)for(var h=s;h>0;h--)t[a][h-1].data&&(t[a][h].data=1,t[a][h].colors=t[a][h-1].colors,t[a][h-1].data=0,t[a][h-1].colors=["rgb(0,0,0)","rgb(0,0,0)","rgb(0,0,0)"]);var n=this;window.addEventListener("keydown",(function(t){switch(t.keyCode){case 37:n.checkMovement(o,-1,0)&&o.x--;break;case 39:n.checkMovement(o,1,0)&&o.x++;break;case 40:n.checkMovement(o,0,1)&&o.y++;break;case 32:case 38:o.data=n.rotateTetrimono(o)}})),this.checkLines(),this.renderBoard(),this.newTetromino(),this.update()},Tetris.prototype.update=function(){var t=this.curPiece;if(this.checkMovement(t,0,1))Date.now()>this.lastMove&&(this.lastMove=Date.now()+this.curSpeed,this.checkMovement(t,0,1)?t.y++:(this.fillBoard(t),this.newTetromino()));else{if(t.y<-1)return this.loseScreen(),!0;this.fillBoard(t),this.newTetromino()}this.render();var i=this;requestAnimationFrame((function(){i.update()}))},Tetris.prototype.renderBoard=function(){var t=this.bgCanvas,i=this.bgCtx,r=this.unitSize,e=this.board,o=this.boardWidth,a=this.boardHeight;i.clearRect(0,0,t.width,t.height);for(var s=0;s<=o;s++)for(var h=0;h<=a;h++)if(0!==e[s][h].data){var n=s*r,d=h*r;i.fillStyle=e[s][h].colors[0],i.fillRect(n,d,r,r),i.fillStyle=e[s][h].colors[1],i.fillRect(n+2,d+2,r-4,r-4),i.fillStyle=e[s][h].colors[2],i.fillRect(n+4,d+4,r-8,r-8)}},Tetris.prototype.render=function(){var t=this.fgCanvas,i=this.fgCtx,r=this.unitSize,e=this.curPiece;i.clearRect(0,0,t.width,t.height);for(var o=0;o<4;o++)for(var a=0;a<4;a++)if(1===e.data[o][a]){var s=(e.x+o)*r,h=(e.y+a)*r;h>-1&&(i.fillStyle=e.colors[0],i.fillRect(s,h,r,r),i.fillStyle=e.colors[1],i.fillRect(s+2,h+2,r-4,r-4),i.fillStyle=e.colors[2],i.fillRect(s+4,h+4,r-8,r-8))}},Tetris.prototype.checkMovement=function(t,i,r){for(var e=t.data,o=t.x,a=t.y,s=this.board,h=this.boardWidth,n=this.boardHeight,d=0;d<4;d++)for(var l=0;l<4;l++)if(1===e[d][l]){if(s[o+d+i]||(s[o+d+i]=[]),s[o+d+i][l+a+r]||(s[o+d+i][l+a+r]={data:0}),o+d+i>=h||o+d+i<0||1==s[o+d+i][l+a+r].data)return!1;if(a+l+r>n)return!1}return!0},Tetris.prototype.checkLines=function(){for(var t=this.board,i=this.boardWidth,r=this.boardHeight,e=this.linesCleared,o=(this.level,r+1);o--;){for(var a=i,s=0;a--;)1===t[a][o].data&&s++;if(s===i){e++,20*Math.round(e/20);for(var h=o;h;){for(a=0;a<=i;a++)h-1>0&&(t[a][h].data=t[a][h-1].data,t[a][h].colors=t[a][h-1].colors);h--}o++}}},Tetris.prototype.loseScreen=function(){for(var t=this.bgCtx,i=this.unitSize,r=this.boardWidth,e=this.boardHeight,o=e-this.loseBlock,a=0;a<r;a++){var s=a*i,h=o*i;t.fillStyle="rgb(80,80,80)",t.fillRect(s,h,i,i),t.fillStyle="rgb(150,150,150)",t.fillRect(s+2,h+2,i-4,i-4),t.fillStyle="rgb(100,100,100)",t.fillRect(s+4,h+4,i-8,i-8)}if(this.loseBlock<=e+1){this.loseBlock++;var n=this;requestAnimationFrame((function(){n.loseScreen()}))}else this.init()},Tetris.prototype.fillBoard=function(t){for(var i=t.data,r=t.x,e=t.y,o=this.board,a=0;a<4;a++)for(var s=0;s<4;s++)1===i[a][s]&&(o[a+r][s+e].data=1,o[a+r][s+e].colors=t.colors);this.checkLines(),this.renderBoard()},Tetris.prototype.rotateTetrimono=function(t){for(var i=[],r=0;r<4;r++){i[r]=[];for(var e=0;e<4;e++)i[r][e]=t.data[3-e][r]}return this.checkMovement({data:i,x:t.x,y:t.y},0,0)||(i=t.data),i},Tetris.prototype.newTetromino=function(){var t=Math.floor(Math.random()*tetrominos.length),i=this.curPiece;i.data=tetrominos[t].data,i.colors=tetrominos[t].colors,i.x=Math.floor(Math.random()*(this.boardWidth-i.data.length+1)),i.y=-4};for(var width=window.innerWidth,boardDiv=20*Math.round(window.innerWidth/20),boards=8,bWidth=boardDiv/boards,tetrisInstances=[],w=0;w<boards;w++)tetrisInstances.push(new Tetris(20*Math.round(w*bWidth/20),0,bWidth));</script><script>window.onload=function(){var n=5,t=document.getElementById("countdown"),e=setInterval((function(){t.textContent=n,--n<0&&clearInterval(e)}),1e3)};</script><script>if(location.pathname.endsWith(".html")){const a=location.pathname.slice(0,-5);location.replace(a)}</script></body></html>
